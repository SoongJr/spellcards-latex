# LaTeX Spell Cards - User Guide

**Version**: 2.2  
**Date**: November 1, 2025

## Overview

This project generates printable spell cards for Pathfinder 1e characters.
Spell cards are designed to be printed on A6 index cards (4 per A4 sheet) with QR codes linking to online references.

## Quick Start

### Prerequisites
- LaTeX installation (with pdflatex, TikZ, qrcode package)
- Python 3.10+ (for the spell card generator)

### Basic Workflow

1. **Generate spell cards** using the Python GUI:
   ```bash
   spell_card_generator/spell_card_generator.sh
   ```

2. **Compile the PDF**:
   ```bash
   latexmk -pdf src/spellcards.tex
   ```

3. **Print** the resulting `src/out/spellcards.pdf` on A4 paper, cut into quarters to get A6 cards.

## Document Class

The project uses a custom document class with two modes:

### Draft Mode
```latex
\documentclass[draft]{spellcard}
```
- **Single-sided** layout
- **No cardify**: One card per page for easy PDF review, not printable
- **Fast compilation**: Use this for testing/development

### Final Mode (Default)
```latex
\documentclass{spellcard}
% or explicitly:
\documentclass[final]{spellcard}
```
- **Double-sided** printing layout
- **Cardified**: 4 A6 cards per A4 sheet, individually rotated so elements that should print at the edge of the card can be printed
- **Production-ready**: Use this for final output

### Deck Index Cards

By default, the document class automatically generates **index cards** for each spell deck.
These list all spells in the deck, organized by level, providing a quick reference when organizing your physical cards.

**Enabled by default** (recommended):
```latex
\documentclass{spellcard}
% or explicitly:
\documentclass[deckindex]{spellcard}
```

**To disable** (if you don't want index cards):
```latex
\documentclass[deckindex=false]{spellcard}
```

**What you get**: At the end of each `\begin{SpellDeck}...\end{SpellDeck}` environment, an index card is automatically generated showing:
- Deck name (or "Known Spells" for the unnamed deck)
- All spells organized by level
- Two-column layout for space efficiency

## Organizing Spells

### Main Document Structure

The main document (`src/spellcards.tex`) is minimal:

```latex
\documentclass{spellcard}
\begin{document}

% Include class-specific spell lists
\input{spells/sor.tex}  % Sorcerer spells

\end{document}
```

### Class Spell Lists

Each character class has a file (e.g., `src/spells/sor.tex`) that defines which spells to print:

```latex
% Sorcerer spell list

% First deck (unnamed - contains all spells)
\begin{SpellDeck}{}
  \IncludeSpell{spells/sor/0/AcidSplash.tex}
  \IncludeSpell{spells/sor/0/DetectMagic.tex}
  \IncludeSpell{spells/sor/1/ComprehendLanguages.tex}
  \IncludeSpell{spells/sor/1/MagicMissile.tex}
  \IncludeSpell{spells/sor/3/Fireball.tex}
\end{SpellDeck}

% Deck 2: Combat Spells
\begin{SpellDeck}{Combat}
  \IncludeSpell{spells/sor/0/AcidSplash.tex}
  \IncludeSpell{spells/sor/1/MagicMissile.tex}
  \IncludeSpell{spells/sor/3/Fireball.tex}
\end{SpellDeck}

% Deck 3: Utility Spells
\begin{SpellDeck}{Utility}
  \IncludeSpell{spells/sor/0/DetectMagic.tex}
  \IncludeSpell{spells/sor/1/ComprehendLanguages.tex}
\end{SpellDeck}
```

### Deck Organization

**Decks** help organize spells thematically. Each deck gets:
- A **label** at the top of each card (e.g., "COMBAT", "UTILITY")
- Visual grouping for easier physical card management

**Unnamed First Deck**: The first deck must be unnamed (empty braces). This is the "spell book" of your charatcer:
```latex
\begin{SpellDeck}{}
  \IncludeSpell{spells/sor/1/MagicMissile.tex}
  \IncludeSpell{spells/sor/3/Fireball.tex}
\end{SpellDeck}
```

**Named Decks**: Subsequent decks get a short label that will be shown at the top of the card:
```latex
\begin{SpellDeck}{Deck Name}
  \IncludeSpell{path/to/spell1.tex}
  \IncludeSpell{path/to/spell2.tex}
\end{SpellDeck}
```

**Alternative Syntax**: You can also use square brackets `[name]` instead of curly braces `{name}`:
```latex
\begin{SpellDeck}[Combat]  % Same as \begin{SpellDeck}{Combat}
  \IncludeSpell{spells/sor/1/MagicMissile.tex}
\end{SpellDeck}
```

### Selective Printing

You can include spells in the file without printing them using `[noprint]`:

```latex
\begin{SpellDeck}[Prepared Spells]
  \IncludeSpell{spells/sor/1/MagicMissile.tex}
  \IncludeSpell[noprint]{spells/sor/1/Shield.tex}  % Don't print, but track in deck
\end{SpellDeck}
```

This is useful for:
- Planning which spells to prepare later
- Printing only new spells gained at a level-up without removing already-printed spells from source
- Keeping deck organization intact while testing
- **Deck index cards**: Spells marked with `[noprint]` still appear on the deck's index card, even though their full cards aren't printed. This lets you print an updated index card showing all known spells without reprinting cards you already have.

## Customizing Spell Cards

### What You Can Customize

Spell cards are **generated by the Python application**. You can:
- ✅ Modify **property values** (range, duration, etc.)
- ✅ Edit the **description** text. Try to fit it on the front face of your card!
- ✅ Change **QR code URLs**
- ❌ **Don't** change the fundamental structure/layout

### Spell Card Structure

A generated spell card looks like this:

```latex
% SPELL-CARD-VERSION: 2.1
\begin{SpellCard}{sor}{Magic Missile}{1}
  \SpellProp{school}{Evocation [Force]}
  \SpellProp{castingtime}{1 standard action}
  \SpellProp{components}{V, S}
  \SpellProp{range}{medium (100 ft. + 10 ft./level)}
  \SpellProp{targets}{up to five creatures}
  \SpellProp{duration}{instantaneous}
  \SpellProp{savingthrow}{none}
  \SpellProp{spellresistance}{yes}
  \SpellProp{attackroll}{none}
  \SpellCardInfo
  \SpellCardQR{https://aonprd.com/SpellDisplay.aspx?ItemName=Magic\%20Missile}
  \SpellCardQR{https://pf.tools/spell/magic-missile}
  %
  % SPELL DESCRIPTION BEGIN
  A missile of magical energy darts forth and unerringly strikes
  its target. The missile deals 1d4+1 points of force damage.
  
  For every two caster levels beyond 1st, you gain an additional
  missile (maximum 5 missiles at 9th level).
  % SPELL DESCRIPTION END
  %
\end{SpellCard}
```

**Important**: Only edit the description between the `% SPELL DESCRIPTION BEGIN` and `% SPELL DESCRIPTION END` marker comments. This ensures the generator can preserve your changes when regenerating.

### Modifying Properties

To change spell attributes, edit the `\SpellProp{key}{value}` lines.

**Critical**: To preserve your modifications on regeneration, you **must** add a comment showing the original value:

For example if there's a house rule to ignore spell components:
```latex
\SpellProp{components}{NULL}% original: {V, S, M (diamond dust worth 500 gp)}
```

**How it works**:
1. Generator sees your modified value has an `% original: {value}` comment
2. Preserves your modified value when regenerating
3. Updates the `% original:` comment if the database changes
4. You can review if database updates conflict with your changes

**Without the comment**: The generator assumes the value came from the database and will overwrite it on regeneration.

See the [Generator Guide](generator-guide.md) for more details on property preservation.

### Editing Descriptions

The description is the text between the `% SPELL DESCRIPTION BEGIN` and `% SPELL DESCRIPTION END` marker comments. You can:
- Abridge long descriptions to fit on one card
- Fix issues of auto-generated description (we use pandoc to convert the HTML description!)
- Add house rules
- Clarify mechanics
- Add notes for your campaign

**Important**: Only edit between the marker comments to ensure the generator preserves your changes.

```latex
%
% SPELL DESCRIPTION BEGIN
  Permanent spells on yourself can be dispelled only by a caster
  of higher level than you were when you cast the spell.

  \bigskip
  \emph{See online for full list of spells that can be made permanent}.\\
  The GM may allow other spells to be made permanent.
% SPELL DESCRIPTION END
%
\end{SpellCard}
```

### QR Codes

Each card can have up to 2 QR codes, usually used for linking to online spell references:

```latex
\SpellCardQR{https://aonprd.com/SpellDisplay.aspx?ItemName=Fireball}  % Primary
\SpellCardQR{https://pf.tools/spell/fireball}                         % Secondary
```

**Positioning**: Primary code will be on the left, secondary on the right of the page.

**Content**: Although meant to be used as links into online documentation (English and German), the content can be arbitrary text.
Feel free to write a companion app that uses one of the codes as spell ID or something.

## Special Commands

### Spell Level Reference Card

Generate a reference card showing all spell level markers (useful for coloring with highlighters):

```latex
\SpellMarkerChart
```

This creates a single card with markers for spell levels 0-9 on the right edge.

### Show Current Deck

Prints debugging output to the console during LaTeX compilation.
No side effect on PDF.

```latex
\ShowDeck
```

## Advanced Customization

### Table Width Ratio

The spell attribute table is split into two columns. By default, they're equal width (50/50).
Depending on the length of values for a given spell, you may wish to adjust this:

```latex
\SpellCardInfo[0.4]  % Left table: 40%, Right table: 60%
\SpellCardInfo[0.6]  % Left table: 60%, Right table: 40%
\SpellCardInfo       % Default: 50/50 split
```

**Note**: The generator preserves custom width ratios when regenerating cards.

### Printer Margins

If your printer has margins that clip the cutting guides, adjust the global margin:

```latex
% In spellcards.sty package options (not recommended for most users)
\usepackage[printer-margin=5mm]{spellcards}
```

**Better approach**: Use your printer's "fit to page" or "scale to fit" setting instead.

## Compilation

### Standard Compilation
```bash
latexmk -pdf src/spellcards.tex
```

Output: `src/out/spellcards.pdf`

### Clean Build
```bash
latexmk -C src/spellcards.tex  # Remove all generated files
latexmk -pdf src/spellcards.tex
```

### Watch Mode (Auto-recompile)
```bash
latexmk -pvc -pdf src/spellcards.tex
```

## Printing Tips

1. **Paper Size**: Use A4 paper (210mm × 297mm)
2. **Print Settings**: 
   - Double-sided printing recommended (front and back aligned)
   - Pro tip: There are actually very few cards with a back face, so most even pages will be empty.  
     So feel free to get just those pages out of the stack and just print the even pages belonging to those cards.  
   - No scaling (100% size)
3. **Cutting**: Follow the cutting guides (thin lines) to get 4 A6 cards (105mm × 148mm) per sheet
4. **Card Stock**: 200-300 gsm cardstock recommended for durability
5. **Sleeving**: Standard trading card sleeves (66mm × 92mm) fit A6 cards folded in half

## Troubleshooting

### Cards on Wrong Pages
- **Problem**: Cards not alternating odd/even pages correctly
- **Solution**: Ensure you're using default final mode, not draft mode

### QR Codes Too Large/Small
- **Problem**: QR codes overlap content or are hard to scan
- **Solution**: QR codes are fixed size (1.5cm). If URLs are very long, consider using a URL shortener

### Compilation Errors
- **Problem**: `! Undefined control sequence`
- **Solution**: Ensure spell card files are version 2.1 format (check `SPELL-CARD-VERSION` comment)

### Missing Spells
- **Problem**: `\IncludeSpell` doesn't output a card
- **Solution**: Check for `[noprint]` option or verify the file exists

## Next Steps

- **Generator Guide**: Learn how to generate and regenerate spell cards using the Python application
- **API Reference**: Complete list of all LaTeX commands and their options
